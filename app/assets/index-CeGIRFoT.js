var Ne=Object.defineProperty;var Se=(o,e,r)=>e in o?Ne(o,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[e]=r;var C=(o,e,r)=>Se(o,typeof e!="symbol"?e+"":e,r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))a(u);new MutationObserver(u=>{for(const f of u)if(f.type==="childList")for(const p of f.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&a(p)}).observe(document,{childList:!0,subtree:!0});function r(u){const f={};return u.integrity&&(f.integrity=u.integrity),u.referrerPolicy&&(f.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?f.credentials="include":u.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function a(u){if(u.ep)return;u.ep=!0;const f=r(u);fetch(u.href,f)}})();function Le(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var y={},oe;function Te(){if(oe)return y;oe=1;function o(t,n,c,i){return new(c||(c=Promise))(function(d,h){function l(_){try{S(i.next(_))}catch(v){h(v)}}function w(_){try{S(i.throw(_))}catch(v){h(v)}}function S(_){var v;_.done?d(_.value):(v=_.value,v instanceof c?v:new c(function(D){D(v)})).then(l,w)}S((i=i.apply(t,[])).next())})}function e(){return s("extensions.getStats")}typeof SuppressedError=="function"&&SuppressedError;var r=Object.freeze({__proto__:null,broadcast:function(t,n){return s("extensions.broadcast",{event:t,data:n})},dispatch:function(t,n,c){return new Promise((i,d)=>o(this,void 0,void 0,function*(){const h=yield e();if(h.loaded.includes(t))if(h.connected.includes(t))try{const l=yield s("extensions.dispatch",{extensionId:t,event:n,data:c});i(l)}catch(l){d(l)}else(function(l,w){l in x?x[l].push(w):x[l]=[w]})(t,{method:"extensions.dispatch",data:{extensionId:t,event:n,data:c},resolve:i,reject:d});else d({code:"NE_EX_EXTNOTL",message:`${t} is not loaded`})}))},getStats:e});function a(t,n){return window.addEventListener(t,n),Promise.resolve({success:!0,message:"Event listener added"})}function u(t,n){const c=new CustomEvent(t,{detail:n});return window.dispatchEvent(c),Promise.resolve({success:!0,message:"Message dispatched"})}function f(t){const n=window.atob(t),c=n.length,i=new Uint8Array(c);for(let d=0;d<c;d++)i[d]=n.charCodeAt(d);return i.buffer}function p(t){let n=new Uint8Array(t),c="";for(let i of n)c+=String.fromCharCode(i);return window.btoa(c)}let g;const m={},N=[],x={};function L(){window.NL_TOKEN&&sessionStorage.setItem("NL_TOKEN",window.NL_TOKEN);const t=Z().split(".")[1],n=window.NL_GINJECTED||window.NL_CINJECTED?"127.0.0.1":window.location.hostname;g=new WebSocket(`ws://${n}:${window.NL_PORT}?connectToken=${t}`),function(){a("ready",()=>o(this,void 0,void 0,function*(){if(yield k(N),!window.NL_EXTENABLED)return;const c=yield e();for(const i of c.connected)u("extensionReady",i)})),a("extClientConnect",c=>{u("extensionReady",c.detail)}),window.NL_EXTENABLED&&a("extensionReady",c=>o(this,void 0,void 0,function*(){c.detail in x&&(yield k(x[c.detail]),delete x[c.detail])}))}(),function(){g.addEventListener("message",c=>{var i,d,h;const l=JSON.parse(c.data);l.id&&l.id in m?(!((i=l.data)===null||i===void 0)&&i.error?(m[l.id].reject(l.data.error),l.data.error.code=="NE_RT_INVTOKN"&&(g.close(),document.body.innerText="",document.write("<code>NE_RT_INVTOKN</code>: Neutralinojs application cannot execute native methods since <code>NL_TOKEN</code> is invalid."))):!((d=l.data)===null||d===void 0)&&d.success&&m[l.id].resolve(l.data.hasOwnProperty("returnValue")?l.data.returnValue:l.data),delete m[l.id]):l.event&&(l.event=="openedFile"&&((h=l==null?void 0:l.data)===null||h===void 0?void 0:h.action)=="dataBinary"&&(l.data.data=f(l.data.data)),u(l.event,l.data))}),g.addEventListener("open",c=>o(this,void 0,void 0,function*(){u("ready")})),g.addEventListener("close",c=>o(this,void 0,void 0,function*(){u("serverOffline",{code:"NE_CL_NSEROFF",message:"Neutralino server is offline. Try restarting the application"})})),g.addEventListener("error",c=>o(this,void 0,void 0,function*(){document.body.innerText="",document.write("<code>NE_CL_IVCTOKN</code>: Neutralinojs application cannot connect with the framework core using <code>NL_TOKEN</code>.")}))}()}function s(t,n){return new Promise((c,i)=>{if((g==null?void 0:g.readyState)!=WebSocket.OPEN)return d={method:t,data:n,resolve:c,reject:i},void N.push(d);var d;const h="10000000-1000-4000-8000-100000000000".replace(/[018]/g,w=>(w^crypto.getRandomValues(new Uint8Array(1))[0]&15>>w/4).toString(16)),l=Z();m[h]={resolve:c,reject:i},g.send(JSON.stringify({id:h,method:t,data:n,accessToken:l}))})}function k(t){return o(this,void 0,void 0,function*(){for(;t.length>0;){const n=t.shift();try{const c=yield s(n.method,n.data);n.resolve(c)}catch(c){n.reject(c)}}})}function Z(){return window.NL_TOKEN||sessionStorage.getItem("NL_TOKEN")||""}function Y(t,n){return s("filesystem.writeBinaryFile",{path:t,data:p(n)})}var pe=Object.freeze({__proto__:null,appendBinaryFile:function(t,n){return s("filesystem.appendBinaryFile",{path:t,data:p(n)})},appendFile:function(t,n){return s("filesystem.appendFile",{path:t,data:n})},copy:function(t,n,c){return s("filesystem.copy",Object.assign({source:t,destination:n},c))},createDirectory:function(t){return s("filesystem.createDirectory",{path:t})},createWatcher:function(t){return s("filesystem.createWatcher",{path:t})},getAbsolutePath:function(t){return s("filesystem.getAbsolutePath",{path:t})},getOpenedFileInfo:function(t){return s("filesystem.getOpenedFileInfo",{id:t})},getPathParts:function(t){return s("filesystem.getPathParts",{path:t})},getRelativePath:function(t,n){return s("filesystem.getRelativePath",{path:t,base:n})},getStats:function(t){return s("filesystem.getStats",{path:t})},getWatchers:function(){return s("filesystem.getWatchers")},move:function(t,n){return s("filesystem.move",{source:t,destination:n})},openFile:function(t){return s("filesystem.openFile",{path:t})},readBinaryFile:function(t,n){return new Promise((c,i)=>{s("filesystem.readBinaryFile",Object.assign({path:t},n)).then(d=>{c(f(d))}).catch(d=>{i(d)})})},readDirectory:function(t,n){return s("filesystem.readDirectory",Object.assign({path:t},n))},readFile:function(t,n){return s("filesystem.readFile",Object.assign({path:t},n))},remove:function(t){return s("filesystem.remove",{path:t})},removeWatcher:function(t){return s("filesystem.removeWatcher",{id:t})},updateOpenedFile:function(t,n,c){return s("filesystem.updateOpenedFile",{id:t,event:n,data:c})},writeBinaryFile:Y,writeFile:function(t,n){return s("filesystem.writeFile",{path:t,data:n})}});function B(t,n){return s("os.execCommand",Object.assign({command:t},n))}var he=Object.freeze({__proto__:null,execCommand:B,getEnv:function(t){return s("os.getEnv",{key:t})},getEnvs:function(){return s("os.getEnvs")},getPath:function(t){return s("os.getPath",{name:t})},getSpawnedProcesses:function(){return s("os.getSpawnedProcesses")},open:function(t){return s("os.open",{url:t})},setTray:function(t){return s("os.setTray",t)},showFolderDialog:function(t,n){return s("os.showFolderDialog",Object.assign({title:t},n))},showMessageBox:function(t,n,c,i){return s("os.showMessageBox",{title:t,content:n,choice:c,icon:i})},showNotification:function(t,n,c){return s("os.showNotification",{title:t,content:n,icon:c})},showOpenDialog:function(t,n){return s("os.showOpenDialog",Object.assign({title:t},n))},showSaveDialog:function(t,n){return s("os.showSaveDialog",Object.assign({title:t},n))},spawnProcess:function(t,n){return s("os.spawnProcess",{command:t,cwd:n})},updateSpawnedProcess:function(t,n,c){return s("os.updateSpawnedProcess",{id:t,event:n,data:c})}}),ge=Object.freeze({__proto__:null,getArch:function(){return s("computer.getArch")},getCPUInfo:function(){return s("computer.getCPUInfo")},getDisplays:function(){return s("computer.getDisplays")},getKernelInfo:function(){return s("computer.getKernelInfo")},getMemoryInfo:function(){return s("computer.getMemoryInfo")},getMousePosition:function(){return s("computer.getMousePosition")},getOSInfo:function(){return s("computer.getOSInfo")}}),me=Object.freeze({__proto__:null,getData:function(t){return s("storage.getData",{key:t})},getKeys:function(){return s("storage.getKeys")},setData:function(t,n){return s("storage.setData",{key:t,data:n})}});function Q(t,n){return s("debug.log",{message:t,type:n})}var we=Object.freeze({__proto__:null,log:Q});function ee(t){return s("app.exit",{code:t})}var ye=Object.freeze({__proto__:null,broadcast:function(t,n){return s("app.broadcast",{event:t,data:n})},exit:ee,getConfig:function(){return s("app.getConfig")},killProcess:function(){return s("app.killProcess")},readProcessInput:function(t){return s("app.readProcessInput",{readAll:t})},restartProcess:function(t){return new Promise(n=>o(this,void 0,void 0,function*(){let c=window.NL_ARGS.reduce((i,d)=>(d.includes(" ")&&(d=`"${d}"`),i+=" "+d),"");t!=null&&t.args&&(c+=" "+t.args),yield B(c,{background:!0}),ee(),n()}))},writeProcessError:function(t){return s("app.writeProcessError",{data:t})},writeProcessOutput:function(t){return s("app.writeProcessOutput",{data:t})}});const j=new WeakMap;function te(t,n){return s("window.move",{x:t,y:n})}function re(){return s("window.getSize")}var ve=Object.freeze({__proto__:null,center:function(){return s("window.center")},create:function(t,n){return new Promise((c,i)=>{function d(l){return typeof l!="string"||(l=l.trim()).includes(" ")&&(l=`"${l}"`),l}n=Object.assign(Object.assign({},n),{useSavedState:!1});let h=window.NL_ARGS.reduce((l,w,S)=>((w.includes("--path=")||w.includes("--debug-mode")||w.includes("--load-dir-res")||S==0)&&(l+=" "+d(w)),l),"");h+=" --url="+d(t);for(let l in n)l!="processArgs"&&(h+=` --window${"-"+l.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}=${d(n[l])}`);n&&n.processArgs&&(h+=" "+n.processArgs),B(h,{background:!0}).then(l=>{c(l)}).catch(l=>{i(l)})})},exitFullScreen:function(){return s("window.exitFullScreen")},focus:function(){return s("window.focus")},getPosition:function(){return s("window.getPosition")},getSize:re,getTitle:function(){return s("window.getTitle")},hide:function(){return s("window.hide")},isFullScreen:function(){return s("window.isFullScreen")},isMaximized:function(){return s("window.isMaximized")},isMinimized:function(){return s("window.isMinimized")},isVisible:function(){return s("window.isVisible")},maximize:function(){return s("window.maximize")},minimize:function(){return s("window.minimize")},move:te,setAlwaysOnTop:function(t){return s("window.setAlwaysOnTop",{onTop:t})},setDraggableRegion:function(t,n={}){return new Promise((c,i)=>{const d=t instanceof Element?t:document.getElementById(t);let h=0,l=0,w=0,S=!1,_=performance.now(),v=n.alwaysCapture;if(!d)return i({code:"NE_WD_DOMNOTF",message:"Unable to find DOM element"});if(j.has(d))return i({code:"NE_WD_ALRDREL",message:"This DOM element is already an active draggable region"});function D(O){return o(this,void 0,void 0,function*(){var R;const F=O.clientX-h,b=O.clientY-l;if(w=Math.sqrt(F*F+b*b),w>=((R=n.dragMinDistance)!==null&&R!==void 0?R:10)&&(S=!0,v||(d.setPointerCapture(O.pointerId),v=!0)),S){const z=performance.now(),W=z-_;return W<5?void 0:(_=z-(W-5),void(yield te(O.screenX-h,O.screenY-l)))}})}function A(O){O.button===0&&(h=O.clientX,l=O.clientY,d.addEventListener("pointermove",D),n.alwaysCapture&&d.setPointerCapture(O.pointerId))}function T(O){d.removeEventListener("pointermove",D),d.releasePointerCapture(O.pointerId)}d.addEventListener("pointerdown",A),d.addEventListener("pointerup",T),d.addEventListener("pointercancel",T),j.set(d,{pointerdown:A,pointerup:T}),c({success:!0,message:"Draggable region was activated"})})},setFullScreen:function(){return s("window.setFullScreen")},setIcon:function(t){return s("window.setIcon",{icon:t})},setSize:function(t){return new Promise((n,c)=>o(this,void 0,void 0,function*(){let i=yield re();s("window.setSize",t=Object.assign(Object.assign({},i),t)).then(d=>{n(d)}).catch(d=>{c(d)})}))},setTitle:function(t){return s("window.setTitle",{title:t})},show:function(){return s("window.show")},snapshot:function(t){return s("window.snapshot",{path:t})},unmaximize:function(){return s("window.unmaximize")},unminimize:function(){return s("window.unminimize")},unsetDraggableRegion:function(t){return new Promise((n,c)=>{const i=t instanceof Element?t:document.getElementById(t);if(!i)return c({code:"NE_WD_DOMNOTF",message:"Unable to find DOM element"});if(!j.has(i))return c({code:"NE_WD_NOTDRRE",message:"DOM element is not an active draggable region"});const{pointerdown:d,pointerup:h}=j.get(i);i.removeEventListener("pointerdown",d),i.removeEventListener("pointerup",h),i.removeEventListener("pointercancel",h),j.delete(i),n({success:!0,message:"Draggable region was deactivated"})})}}),Pe=Object.freeze({__proto__:null,broadcast:function(t,n){return s("events.broadcast",{event:t,data:n})},dispatch:u,off:function(t,n){return window.removeEventListener(t,n),Promise.resolve({success:!0,message:"Event listener removed"})},on:a});let I=null;var _e=Object.freeze({__proto__:null,checkForUpdates:function(t){return new Promise((n,c)=>o(this,void 0,void 0,function*(){if(!t)return c({code:"NE_RT_NATRTER",message:"Missing require parameter: url"});try{const i=yield fetch(t);I=JSON.parse(yield i.text()),function(d){return!!(d.applicationId&&d.applicationId==window.NL_APPID&&d.version&&d.resourcesURL)}(I)?n(I):c({code:"NE_UP_CUPDMER",message:"Invalid update manifest or mismatching applicationId"})}catch{c({code:"NE_UP_CUPDERR",message:"Unable to fetch update manifest"})}}))},install:function(){return new Promise((t,n)=>o(this,void 0,void 0,function*(){if(!I)return n({code:"NE_UP_UPDNOUF",message:"No update manifest loaded"});try{const c=yield fetch(I.resourcesURL),i=yield c.arrayBuffer();yield Y(window.NL_PATH+"/resources.neu",i),t({success:!0,message:"Update installed. Restart the process to see updates"})}catch{n({code:"NE_UP_UPDINER",message:"Update installation error"})}}))}}),Oe=Object.freeze({__proto__:null,clear:function(){return s("clipboard.clear")},getFormat:function(){return s("clipboard.getFormat")},readImage:function(t=""){return new Promise((n,c)=>{s("clipboard.readImage").then(i=>{if(i){const d=window.atob(i.data);let h,l,w,S=i.bpp==32?4:3;switch(t.toLowerCase()){case"rgb":h=i.width*i.height*3,l=[0,1,2];break;case"rgba":h=i.width*i.height*4,l=[0,1,2,3];break;case"argb":h=i.width*i.height*4,l=[3,0,1,2];break;case"bgra":h=i.width*i.height*4,l=[2,1,0,3];break;default:h=d.length,w=new Uint8Array(h);for(let b=0;b<h;b++)w[b]=d.charCodeAt(b);return i.data=w,void n(i)}w=new Uint8Array(h);let _,v,D,A,T,O=new Uint8Array(new Uint32Array([255]).buffer)[0]==255,R=[],F=0;for(let b=0;b<d.length;b+=S)_=d.charCodeAt(b),v=d.charCodeAt(b+1),D=d.charCodeAt(b+2),A=S==4?d.charCodeAt(b+3):255,T=O?(A<<24|D<<16|v<<8|_)>>>0:(_<<24|v<<16|D<<8|A)>>>0,R=[T>>i.redShift&255,T>>i.greenShift&255,T>>i.blueShift&255,T>>i.alphaShift&255],l.forEach((z,W)=>{w[W+F]=R[z]}),F+=l.length;i.data=w}n(i)}).catch(i=>{c(i)})})},readText:function(){return s("clipboard.readText")},writeImage:function(t){const n=Object.assign({},t);return t!=null&&t.data&&(n.data=p(t.data)),s("clipboard.writeImage",n)},writeText:function(t){return s("clipboard.writeText",{data:t})}}),be=Object.freeze({__proto__:null,extractDirectory:function(t,n){return s("resources.extractDirectory",{path:t,destination:n})},extractFile:function(t,n){return s("resources.extractFile",{path:t,destination:n})},getFiles:function(){return s("resources.getFiles")},getStats:function(t){return s("resources.getStats",{path:t})},readBinaryFile:function(t){return new Promise((n,c)=>{s("resources.readBinaryFile",{path:t}).then(i=>{n(f(i))}).catch(i=>{c(i)})})},readFile:function(t){return s("resources.readFile",{path:t})}}),Ee=Object.freeze({__proto__:null,getMounts:function(){return s("server.getMounts")},mount:function(t,n){return s("server.mount",{path:t,target:n})},unmount:function(t){return s("server.unmount",{path:t})}}),xe=Object.freeze({__proto__:null,getMethods:function(){return s("custom.getMethods")}});let ne=!1;return y.app=ye,y.clipboard=Oe,y.computer=ge,y.custom=xe,y.debug=we,y.events=Pe,y.extensions=r,y.filesystem=pe,y.init=function(t={}){if(t=Object.assign({exportCustomMethods:!0},t),!ne){if(L(),window.NL_ARGS.find(n=>n=="--neu-dev-auto-reload")&&a("neuDev_reloadApp",()=>o(this,void 0,void 0,function*(){yield Q("Reloading the application..."),location.reload()})),t.exportCustomMethods&&window.NL_CMETHODS&&window.NL_CMETHODS.length>0)for(const n of window.NL_CMETHODS)Neutralino.custom[n]=(...c)=>{let i={};for(const[d,h]of c.entries())i=typeof h!="object"||Array.isArray(h)||h==null?Object.assign(Object.assign({},i),{["arg"+d]:h}):Object.assign(Object.assign({},i),h);return s("custom."+n,i)};window.NL_CVERSION="5.6.0",window.NL_CCOMMIT="425c526c318342e0e5d0f17caceef2a53049eda4",ne=!0}},y.os=he,y.resources=be,y.server=Ee,y.storage=me,y.updater=_e,y.window=ve,y}var De=Te();const ue=Le(De),Ce=Object.freeze(Object.defineProperty({__proto__:null,default:ue},Symbol.toStringTag,{value:"Module"})),$e="modulepreload",Ae=function(o){return"/"+o},se={},Re=function(e,r,a){let u=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const p=document.querySelector("meta[property=csp-nonce]"),g=(p==null?void 0:p.nonce)||(p==null?void 0:p.getAttribute("nonce"));u=Promise.allSettled(r.map(m=>{if(m=Ae(m),m in se)return;se[m]=!0;const N=m.endsWith(".css"),x=N?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${x}`))return;const L=document.createElement("link");if(L.rel=N?"stylesheet":$e,N||(L.as="script"),L.crossOrigin="",L.href=m,g&&L.setAttribute("nonce",g),document.head.appendChild(L),N)return new Promise((s,k)=>{L.addEventListener("load",s),L.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${m}`)))})}))}function f(p){const g=new Event("vite:preloadError",{cancelable:!0});if(g.payload=p,window.dispatchEvent(g),!g.defaultPrevented)throw p}return u.then(p=>{for(const g of p||[])g.status==="rejected"&&f(g.reason);return e().catch(f)})};(o=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(o,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):o)(function(o){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+o+'" is not supported')});var J,V,je=async o=>{try{let e=await(0,eval)(o.detail.js);J.send(JSON.stringify({token:V,command:"execResult",id:o.detail.requestId,returnValue:e}))}catch(e){J.send(JSON.stringify({token:V,command:"execResult",id:o.detail.requestId,error:e.message,stack:e.stack}))}},Ie=async(o,e,r)=>{J=r,V=e,o.events.on("buntralinoEval",je),o.events.on("buntralinoNavigate",a=>{window.location.href=a.detail.url}),o.events.on("buntralinoReload",()=>{window.location.reload()})},Fe=()=>Date.now().toString(36)+Math.random().toString(36),P;window.Neutralino&&(P=window.Neutralino);var X,H,$,de,le,fe=new Promise((o,e)=>{de=o,le=e});(async()=>(P||(P=(await Re(async()=>{const{default:o}=await Promise.resolve().then(()=>Ce);return{default:o}},void 0)).default),P.events.on("ready",async()=>{if(window.NL_RESMODE==="bundle"&&!window.NL_ARGS.some(o=>o.startsWith("--buntralino-name="))){let o=await P.app.getConfig(),e=`${window.NL_CWD}/${o.cli.binaryName}`;window.NL_OS==="Windows"&&(e+=".exe");try{P.filesystem.getStats(e),await P.os.execCommand(`"${e}"`,{background:!0,cwd:window.NL_CWD}),P.app.exit()}catch{window.alert('"neutralino" is not the main executable! Please run the other one.'),P.app.exit()}finally{return}}try{let o=window.NL_ARGS.find(p=>p.startsWith("--buntralino-port=")),e=window.NL_ARGS.find(p=>p.startsWith("--buntralino-name="));if(!o||!e)return;let[,r]=o.split("="),[,a]=e.split("="),u=window.NL_TOKEN||sessionStorage.NL_TOKEN;$=new WebSocket(`ws://127.0.0.1:${r}`),$.onopen=()=>{console.debug("⚛️ Announcing ourself to Buntralino…"),$.send(JSON.stringify({command:"announceSelf",name:a,NL_PORT:window.NL_PORT,NL_TOKEN:u}))};let f=p=>{P.events.off("buntralinoRegisterParent",f),!(!p.detail.token||!p.detail.port)&&(X=p.detail.token,H=p.detail.port,$=new WebSocket(`ws://127.0.0.1:${H}`),$.onopen=()=>{Ie(P,X,$),console.log("⚛️🥟 Buntralino connected on port",H),de()})};P.events.on("buntralinoRegisterParent",f)}catch(o){le(o),console.error("⚛️ Buntralino failed with",o)}}),P.init()))();var qe=async(o,e)=>{await fe;let r=Fe();return $.send(JSON.stringify({token:X,command:"run",method:o,id:r,payload:e})),new Promise((a,u)=>{let f=p=>{let{id:g,returnValue:m,error:N,stack:x}=p.detail;g===r&&(P.events.off("buntralinoExecResult",f),"error"in p.detail&&u(new Error(N??"Unknown error",{cause:x?new Error(x):null})),a(m))};P.events.on("buntralinoExecResult",f)})},Ue=fe;class ke{constructor(){C(this,"parsers",[]);this.registerDefaultParsers()}registerParser(e){this.parsers.push(e),this.parsers.sort((r,a)=>r.priority-a.priority)}removeParser(e){const r=this.parsers.findIndex(a=>a.name===e);return r!==-1?(this.parsers.splice(r,1),!0):!1}safeParse(e){if(e==null||typeof e!="string")return{success:!0,value:e,type:typeof e};const r=e.trim();if(!r)return{success:!0,value:r,type:"string"};for(const a of this.parsers)if(a.canParse(r))try{return{success:!0,value:a.parse(r),type:a.name}}catch(u){console.warn(`Parser '${a.name}' falló:`,u);continue}return{success:!0,value:r,type:"string"}}registerDefaultParsers(){this.registerParser({name:"json-strict",priority:1,canParse:e=>e.startsWith("{")&&e.endsWith("}")||e.startsWith("[")&&e.endsWith("]"),parse:e=>JSON.parse(e)}),this.registerParser({name:"json-sloppy",priority:2,canParse:e=>e.includes("{")||e.includes("[")||e.includes(":")||e.includes(","),parse:e=>{let r=e;return r=r.replace(/([{,]\s*)([a-zA-Z0-9_$]+)\s*:/g,'$1"$2":'),r=r.replace(/:\s*'([^']*)'/g,': "$1"'),r=r.replace(/:\s*([a-zA-Z][a-zA-Z0-9_]*)\s*([,}])/g,': "$1"$2'),r=r.replace(/,\s*([}\]])/g,"$1"),r.includes(":")&&!r.trim().startsWith("{")&&(r=`{${r}}`),JSON.parse(r)}}),this.registerParser({name:"number",priority:3,canParse:e=>/^-?\d*\.?\d+([eE][+-]?\d+)?$/.test(e),parse:e=>{const r=Number(e);if(isNaN(r))throw new Error("No es un número válido");return r}}),this.registerParser({name:"boolean",priority:4,canParse:e=>{const r=e.toLowerCase();return r==="true"||r==="false"||r==="yes"||r==="no"||r==="on"||r==="off"||r==="1"||r==="0"},parse:e=>{const r=e.toLowerCase();return r==="true"||r==="yes"||r==="on"||r==="1"}}),this.registerParser({name:"date-iso",priority:5,canParse:e=>/^\d{4}-\d{2}-\d{2}(T\d{2}:\d{2}:\d{2}(\.\d{3})?Z?)?$/.test(e),parse:e=>new Date(e)}),this.registerParser({name:"url",priority:6,canParse:e=>{try{return new URL(e),!0}catch{return!1}},parse:e=>new URL(e)}),this.registerParser({name:"csv-array",priority:7,canParse:e=>e.includes(",")&&!e.includes("{")&&!e.includes("["),parse:e=>e.split(",").map(r=>{const a=r.trim();return this.safeParse(a).value})}),this.registerParser({name:"null",priority:8,canParse:e=>{const r=e.toLowerCase();return r==="null"||r==="undefined"||r==="none"},parse:e=>e.toLowerCase()==="undefined"?void 0:null})}parse(e){return this.safeParse(e).value}getRegisteredParsers(){return this.parsers.map(e=>e.name)}}const ze=new ke;function M(o){return ze.parse(o)}class We{constructor(){C(this,"config",{enabled:!1,url:"",timeout:3e4})}update(e){this.config={...this.config,...e}}get(){return{...this.config}}isEnabled(){return this.config.enabled&&!!this.config.url}getAuthHeaders(){return this.config.auth?{"Proxy-Authorization":`Basic ${btoa(`${this.config.auth.username}:${this.config.auth.password}`)}`}:{}}getProxyUrl(){return this.config.url}getTimeout(){return this.config.timeout||3e4}}const E=new We;E.update({enabled:!0,url:"http://localhost:3001"});async function ie(o){if(o.status===204)return Promise.resolve(void 0);const e=await o.text();if(!e)return Promise.resolve(void 0);try{return M(e)}catch(r){return console.error("Falló el análisis de la respuesta:",r),Promise.reject(new Error("La respuesta no pudo ser analizada."))}}function q(o,e={}){const{useProxy:r=E.isEnabled(),proxyConfig:a,...u}=e;if(!r)return[o,u];if(a){const f=E.get();E.update(a);const p=ae(o,u);return E.update(f),p}return ae(o,u)}function Me(o){if(!o)return{};if(o instanceof Headers){const e={};return o.forEach((r,a)=>{e[a]=r}),e}if(Array.isArray(o)){const e={};return o.forEach(([r,a])=>{e[r]=a}),e}return o}function ae(o,e){if(!E.isEnabled())return[o,e];const r=E.getProxyUrl(),a=E.getAuthHeaders(),u=Me(e.headers),f=r;console.log("url",o);const p={...e,headers:{...u,...a,"X-Proxy-Target":`${encodeURIComponent(o)}`},signal:AbortSignal.timeout(E.getTimeout())};return[f,p]}async function U(o,e){try{const r=await o();return await ie(r)}catch(r){if(console.warn("Error con proxy, intentando sin proxy:",r),e)try{const a=await e();return await ie(a)}catch(a){throw console.error("Error también sin proxy:",a),a}throw r}}const Be={get:(o,e={})=>{const[r,a]=q(o,{...e,method:"GET"}),u=()=>fetch(r,a),f=e.useProxy!==!1?()=>fetch(o,{...e,method:"GET"}):void 0;return U(u,f)},post:(o,e={},r={})=>{let a={...r,method:"POST"};if(e instanceof FormData){const m={};r.headers&&Object.entries(r.headers).forEach(([N,x])=>{N.toLowerCase()!=="content-type"&&(m[N]=x)}),a={...a,headers:m,body:e}}else{const m={"Content-Type":"application/json",...r.headers};a={...a,headers:m,body:JSON.stringify(e)}}const[u,f]=q(o,a),p=()=>fetch(u,f),g=r.useProxy!==!1?()=>fetch(o,a):void 0;return U(p,g)},put:(o,e={},r={})=>{const a={"Content-Type":"application/json",...r.headers},u={...r,method:"PUT",headers:a,body:JSON.stringify(e)},[f,p]=q(o,u),g=()=>fetch(f,p),m=r.useProxy!==!1?()=>fetch(o,u):void 0;return U(g,m)},patch:(o,e={},r={})=>{const a={"Content-Type":"application/json",...r.headers},u={...r,method:"PATCH",headers:a,body:JSON.stringify(e)},[f,p]=q(o,u),g=()=>fetch(f,p),m=r.useProxy!==!1?()=>fetch(o,u):void 0;return U(g,m)},delete:(o,e={})=>{const[r,a]=q(o,{...e,method:"DELETE"}),u=()=>fetch(r,a),f=e.useProxy!==!1?()=>fetch(o,{...e,method:"DELETE"}):void 0;return U(u,f)}},G={host:"localhost",port:3001,protocol:"http",getFullUrl(){return`${this.protocol}://${this.host}:${this.port}`},update(o){Object.assign(this,o),console.log("API config updated:",this.getFullUrl())}},ce={getItem:()=>null,setItem:()=>{},removeItem:()=>{},clear:()=>{},length:0,key:()=>null},K=typeof window<"u"&&window.localStorage||ce;class He{constructor(e){C(this,"config");C(this,"http");C(this,"token");C(this,"user");this.config=e,this.http=Be;const r=M(K.getItem("info"))||{};this.token=r.token||K.getItem("token")||void 0,this.user=M(r.user||M(K.getItem("user")))||{},this.initializeProxy()}initializeProxy(){this.config.proxy&&E.update(this.config.proxy)}get host(){return this.config.getFullUrl()}updateConfig(e){this.config.update(e),e.proxy&&E.update(e.proxy)}configureProxy(e){E.update(e)}toggleProxy(e){E.update({enabled:e})}getProxyConfig(){return E.get()}_authHeaders(e="application/json"){const r={Authorization:`${this.token}`};return e&&(r["Content-Type"]=e),r}_requestOptions(e={},r="application/json"){return{headers:{...this._authHeaders(r),...e.headers},...e}}async request(e){try{return await e}catch(r){throw console.error("Error en la llamada a la API:",r),r}}async get(e,r={}){const a=`${this.host}${e}`,u=this._requestOptions(r);return this.request(this.http.get(a,u))}async post(e,r={},a={}){const u=`${this.host}${e}`,f=this._requestOptions(a);return this.request(this.http.post(u,r,f))}async put(e,r={},a={}){const u=`${this.host}${e}`,f=this._requestOptions(a);return this.request(this.http.put(u,r,f))}async patch(e,r={},a={}){const u=`${this.host}${e}`,f=this._requestOptions(a);return this.request(this.http.patch(u,r,f))}async delete(e,r={}){const a=`${this.host}${e}`,u=this._requestOptions(r);return this.request(this.http.delete(a,u))}async getWithProxy(e,r,a={}){return this.get(e,{...a,useProxy:!0,proxyConfig:r})}async postWithProxy(e,r={},a,u={}){return this.post(e,r,{...u,useProxy:!0,proxyConfig:a})}async getWithoutProxy(e,r={}){return this.get(e,{...r,useProxy:!1})}}class Ke extends He{constructor(){super(G)}endpoint(e,r){return r?`/tasks/get/${e}/${r}`:`/tasks/get/${e}`}async getAll(e){const r=`/tasks/get/${e}`;return this.getWithProxy(r,{enabled:!0,url:""})}async getById(e,r){return this.request(this.http.get(`${this.host}/tasks/get/${e}/${r}`,{headers:this._authHeaders()}))}async save(e,r){return this.request(this.http.post(`${this.host}/tasks/save/${e}`,r,{headers:this._authHeaders()}))}async update(e,r,a){return this.request(this.http.put(`${this.host}/tasks/update/${e}/${r}`,a,{headers:this._authHeaders()}))}async remove(e,r){return this.request(this.http.delete(`${this.host}/tasks/remove/${e}/${r}`,{headers:this._authHeaders()}))}async markComplete(e,r){return this.request(this.http.put(`${this.host}/tasks/complete/${e}/${r}`,{},{headers:this._authHeaders()}))}async markIncomplete(e,r){return this.request(this.http.put(`${this.host}/tasks/uncomplete/${e}/${r}`,{},{headers:this._authHeaders()}))}}const Je=new Ke;ue.init();(async()=>{await Ue;const o={},e=await Promise.race([qe("getURL",{message:"Hello, Buntralino!"}),new Promise(u=>setTimeout(()=>u(o),5e3))]);console.log("response",e),e&&G.update(e);const r=await Je.getAll("overlay");console.log("resultApi",r);const a=document.getElementById("BuntralinoQR");a.src=G.getFullUrl()+"/qr"})();
